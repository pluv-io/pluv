# @pluv/platform-pluv

## 2.2.3

### Patch Changes

- feeae21: Added debug logging.
    - @pluv/crdt@2.2.3
    - @pluv/io@2.2.3
    - @pluv/types@2.2.3

## 2.2.2

### Patch Changes

- @pluv/crdt@2.2.2
- @pluv/io@2.2.2
- @pluv/types@2.2.2

## 2.2.1

### Patch Changes

- 6563957: Fix `createToken` throwing a TypeError.
    - @pluv/crdt@2.2.1
    - @pluv/io@2.2.1
    - @pluv/types@2.2.1

## 2.2.0

### Patch Changes

- Updated dependencies [cb660cd]
    - @pluv/io@2.2.0
    - @pluv/crdt@2.2.0
    - @pluv/types@2.2.0

## 2.1.0

### Patch Changes

- @pluv/crdt@2.1.0
- @pluv/io@2.1.0
- @pluv/types@2.1.0

## 2.0.2

### Patch Changes

- @pluv/crdt@2.0.2
- @pluv/io@2.0.2
- @pluv/types@2.0.2

## 2.0.1

### Patch Changes

- @pluv/crdt@2.0.1
- @pluv/io@2.0.1
- @pluv/types@2.0.1

## 2.0.0

### Patch Changes

- Updated dependencies [047a1d8]
    - @pluv/types@2.0.0
    - @pluv/crdt@2.0.0
    - @pluv/io@2.0.0

## 1.0.2

### Patch Changes

- @pluv/crdt@1.0.2
- @pluv/io@1.0.2
- @pluv/types@1.0.2

## 1.0.1

### Patch Changes

- Updated dependencies [c583be9]
    - @pluv/io@1.0.1
    - @pluv/crdt@1.0.1
    - @pluv/types@1.0.1

## 1.0.0

### Major Changes

- af94706: pluv.io is now stable and production ready!

    With this v1 release, pluv.io will now follow [semantic versioning](https://semver.org/) with more comprehensive release notes for future changes to the library.

    Checkout the [full documentation here](https://pluv.io/docs/introduction) to get started today!

### Patch Changes

- Updated dependencies [af94706]
    - @pluv/crdt@1.0.0
    - @pluv/io@1.0.0
    - @pluv/types@1.0.0

## 0.44.2

### Patch Changes

- @pluv/crdt@0.44.2
- @pluv/io@0.44.2
- @pluv/types@0.44.2

## 0.44.1

### Patch Changes

- @pluv/crdt@0.44.1
- @pluv/io@0.44.1
- @pluv/types@0.44.1

## 0.44.0

### Patch Changes

- @pluv/crdt@0.44.0
- @pluv/io@0.44.0
- @pluv/types@0.44.0

## 0.43.0

### Patch Changes

- Updated dependencies [e60a677]
- Updated dependencies [0063e80]
- Updated dependencies [244a973]
- Updated dependencies [4b0fbb3]
    - @pluv/io@0.43.0
    - @pluv/crdt@0.43.0
    - @pluv/types@0.43.0

## 0.42.0

### Patch Changes

- def08bc: Fix default endpoint for `createToken`.
- Updated dependencies [cf1529a]
    - @pluv/io@0.42.0
    - @pluv/crdt@0.42.0
    - @pluv/types@0.42.0

## 0.41.7

### Patch Changes

- c698c24: Update hidden endpoints parameter to be provided as a function.
    - @pluv/crdt@0.41.7
    - @pluv/io@0.41.7
    - @pluv/types@0.41.7

## 0.41.6

### Patch Changes

- @pluv/crdt@0.41.6
- @pluv/io@0.41.6
- @pluv/types@0.41.6

## 0.41.5

### Patch Changes

- @pluv/crdt@0.41.5
- @pluv/io@0.41.5
- @pluv/types@0.41.5

## 0.41.4

### Patch Changes

- 8857e8e: Added the ability to use functions to return public keys, secret keys and webhook secrets for `@pluv/platform-pluv`.
    - @pluv/crdt@0.41.4
    - @pluv/io@0.41.4
    - @pluv/types@0.41.4

## 0.41.3

### Patch Changes

- Updated dependencies [49051c0]
    - @pluv/io@0.41.3
    - @pluv/crdt@0.41.3
    - @pluv/types@0.41.3

## 0.41.2

### Patch Changes

- @pluv/crdt@0.41.2
- @pluv/io@0.41.2
- @pluv/types@0.41.2

## 0.41.1

### Patch Changes

- @pluv/crdt@0.41.1
- @pluv/io@0.41.1
- @pluv/types@0.41.1

## 0.41.0

### Patch Changes

- Updated dependencies [73adf21]
- Updated dependencies [f02a430]
- Updated dependencies [0b908b3]
- Updated dependencies [6422f3b]
- Updated dependencies [555b88d]
- Updated dependencies [a663c65]
- Updated dependencies [555b88d]
    - @pluv/io@0.41.0
    - @pluv/crdt@0.41.0
    - @pluv/types@0.41.0

## 0.40.2

### Patch Changes

- @pluv/crdt@0.40.2
- @pluv/io@0.40.2
- @pluv/types@0.40.2

## 0.40.1

### Patch Changes

- @pluv/crdt@0.40.1
- @pluv/io@0.40.1
- @pluv/types@0.40.1

## 0.40.0

### Patch Changes

- @pluv/crdt@0.40.0
- @pluv/io@0.40.0
- @pluv/types@0.40.0

## 0.39.1

### Patch Changes

- @pluv/crdt@0.39.1
- @pluv/io@0.39.1
- @pluv/types@0.39.1

## 0.39.0

### Patch Changes

- Updated dependencies [fe6e239]
- Updated dependencies [737d508]
    - @pluv/io@0.39.0
    - @pluv/crdt@0.39.0
    - @pluv/types@0.39.0

## 0.38.14

### Patch Changes

- @pluv/crdt@0.38.14
- @pluv/io@0.38.14
- @pluv/types@0.38.14

## 0.38.13

### Patch Changes

- Updated dependencies [809afd3]
    - @pluv/io@0.38.13
    - @pluv/crdt@0.38.13
    - @pluv/types@0.38.13

## 0.38.12

### Patch Changes

- @pluv/crdt@0.38.12
- @pluv/io@0.38.12
- @pluv/types@0.38.12

## 0.38.11

### Patch Changes

- @pluv/crdt@0.38.11
- @pluv/io@0.38.11
- @pluv/types@0.38.11

## 0.38.10

### Patch Changes

- @pluv/crdt@0.38.10
- @pluv/io@0.38.10
- @pluv/types@0.38.10

## 0.38.9

### Patch Changes

- 9b3af07: Updated internal event handlers to return more meaningful status codes and room identifiers.
    - @pluv/crdt@0.38.9
    - @pluv/io@0.38.9
    - @pluv/types@0.38.9

## 0.38.8

### Patch Changes

- a39343b: Fix the `onUserDisconnected` event triggering when `onUserConnected` event triggers.
    - @pluv/crdt@0.38.8
    - @pluv/io@0.38.8
    - @pluv/types@0.38.8

## 0.38.7

### Patch Changes

- 05c6f1a: Fix `TypeError` on event handler invocations once again.
    - @pluv/crdt@0.38.7
    - @pluv/io@0.38.7
    - @pluv/types@0.38.7

## 0.38.6

### Patch Changes

- 07fbeef: Fix `TypeError` on event handler invocations.
    - @pluv/crdt@0.38.6
    - @pluv/io@0.38.6
    - @pluv/types@0.38.6

## 0.38.5

### Patch Changes

- 77df696: Fixed platform event contexts being undefined.
    - @pluv/crdt@0.38.5
    - @pluv/io@0.38.5
    - @pluv/types@0.38.5

## 0.38.4

### Patch Changes

- 15399b7: Fix webhook signature validation.
    - @pluv/crdt@0.38.4
    - @pluv/io@0.38.4
    - @pluv/types@0.38.4

## 0.38.3

### Patch Changes

- Updated dependencies [8346273]
    - @pluv/io@0.38.3
    - @pluv/crdt@0.38.3
    - @pluv/types@0.38.3

## 0.38.2

### Patch Changes

- Updated dependencies [039cd64]
    - @pluv/io@0.38.2
    - @pluv/crdt@0.38.2
    - @pluv/types@0.38.2

## 0.38.1

### Patch Changes

- @pluv/crdt@0.38.1
- @pluv/io@0.38.1
- @pluv/types@0.38.1

## 0.38.0

### Patch Changes

- Updated dependencies [f4ceca3]
    - @pluv/types@0.38.0
    - @pluv/io@0.38.0
    - @pluv/crdt@0.38.0

## 0.37.7

### Patch Changes

- c874f25: Fixed webhook signature verification.
    - @pluv/crdt@0.37.7
    - @pluv/io@0.37.7
    - @pluv/types@0.37.7

## 0.37.6

### Patch Changes

- Updated dependencies [3a874f1]
    - @pluv/io@0.37.6
    - @pluv/crdt@0.37.6
    - @pluv/types@0.37.6

## 0.37.5

### Patch Changes

- Updated dependencies [9a9ecee]
    - @pluv/io@0.37.5
    - @pluv/crdt@0.37.5
    - @pluv/types@0.37.5

## 0.37.4

### Patch Changes

- @pluv/crdt@0.37.4
- @pluv/io@0.37.4
- @pluv/types@0.37.4

## 0.37.3

### Patch Changes

- @pluv/crdt@0.37.3
- @pluv/io@0.37.3
- @pluv/types@0.37.3

## 0.37.2

### Patch Changes

- @pluv/crdt@0.37.2
- @pluv/io@0.37.2
- @pluv/types@0.37.2

## 0.37.1

### Patch Changes

- @pluv/crdt@0.37.1
- @pluv/io@0.37.1
- @pluv/types@0.37.1

## 0.37.0

### Minor Changes

- 5165be0: **BREAKING**

    Updated the `platformPluv` function to return an entire `createIO` input object. Now `createIO` must be called with `platformPluv`'s return value as an input.

    ```ts
    // Before

    import { createIO } from "@pluv/io";
    import { platformPluv } from "@pluv/platform-pluv";

    export const io = createIO({
        authorize: {
            // ...
        },
        context: {
            // ...
        },
        platform: platformPluv({
            // ...
        }),
        // ...
    });

    // After

    import { createIO } from "@pluv/io";
    import { platformPluv } from "@pluv/platform-pluv";

    export const io = createIO(
        platformPluv({
            authorize: {
                // ...
            },
            context: {
                // ...
            },
        }),
    );
    ```

### Patch Changes

- 9b74abb: Improved type inference when calling `PluvIO.server` to not include options that are always undefined (i.e. are not allowed by the specified platform).
- Updated dependencies [9b74abb]
    - @pluv/io@0.37.0
    - @pluv/crdt@0.37.0
    - @pluv/types@0.37.0

## 0.36.0

### Patch Changes

- @pluv/crdt@0.36.0
- @pluv/io@0.36.0
- @pluv/types@0.36.0

## 0.35.4

### Patch Changes

- Updated dependencies [5d3a56f]
    - @pluv/io@0.35.4
    - @pluv/crdt@0.35.4
    - @pluv/types@0.35.4

## 0.35.3

### Patch Changes

- @pluv/crdt@0.35.3
- @pluv/io@0.35.3
- @pluv/types@0.35.3

## 0.35.2

### Patch Changes

- 47ab053: Remove unused check for `authorize.required` for `@pluv/platform-pluv`.
- Updated dependencies [81cb692]
    - @pluv/types@0.35.2
    - @pluv/io@0.35.2
    - @pluv/crdt@0.35.2

## 0.35.1

### Patch Changes

- @pluv/crdt@0.35.1
- @pluv/io@0.35.1
- @pluv/types@0.35.1

## 0.35.0

### Patch Changes

- Updated dependencies [c9073ad]
    - @pluv/io@0.35.0
    - @pluv/crdt@0.35.0
    - @pluv/types@0.35.0

## 0.34.1

### Patch Changes

- Updated dependencies [d639427]
    - @pluv/io@0.34.1
    - @pluv/crdt@0.34.1
    - @pluv/types@0.34.1

## 0.34.0

### Minor Changes

- 70af3b2: **BREAKING**: The API has been updated to now be called as function `platformPluv` into `createIO` from `@pluv/io`.

    ```ts
    // Before

    import { createIO } from "@pluv/platform-pluv";

    export const io = createIO({
        authorize: {
            user: z.object({
                id: z.string(),
            }),
        },
        basePath: "/api/pluv",
        publicKey: "pk_...",
        secretKey: "sk_...",
        webhookSecret: "whsec_...",
    });

    export const GET = pluv.handler;

    // After

    import { createIO } from "@pluv/io";
    import { platformPluv } from "@pluv/platform-pluv";

    export const io = createIO({
        authorize: {
            user: z.object({
                id: z.string(),
            }),
        },
        platform: platformPluv({
            basePath: "/api/pluv",
            publicKey: "pk_...",
            secretKey: "sk_...",
            webhookSecret: "whsec_...",
        }),
    });

    export const ioServer = io.server();

    // Example: If you're on Next.js
    export const GET = ioServer.fetch;
    ```

### Patch Changes

- Updated dependencies [0c920ea]
- Updated dependencies [70af3b2]
    - @pluv/io@0.34.0
    - @pluv/crdt@0.34.0
    - @pluv/types@0.34.0

## 0.33.0

### Patch Changes

- f14b3be: Updated webhooks path to base path.
    - @pluv/crdt@0.33.0
    - @pluv/io@0.33.0
    - @pluv/types@0.33.0

## 0.32.9

### Patch Changes

- @pluv/crdt@0.32.9
- @pluv/io@0.32.9
- @pluv/types@0.32.9

## 0.32.8

### Patch Changes

- Updated dependencies [e659f8a]
    - @pluv/io@0.32.8
    - @pluv/crdt@0.32.8
    - @pluv/types@0.32.8

## 0.32.7

### Patch Changes

- a9a1f7b: Export event schemas.
    - @pluv/crdt@0.32.7
    - @pluv/io@0.32.7
    - @pluv/types@0.32.7

## 0.32.6

### Patch Changes

- 25292d4: Fix event payload types to only contain serializable fields.
- c0956e7: Add `onUserConnected` and `onUserDisconnected` events on `PluvServer`.

    ```ts
    import { createIO } from "@pluv/io";

    const io = createIO({
        /* ... */
    });

    const ioServer = io.server({
        // ...
        onUserConnected: (event) => {
            // ...
        },
        onUserDisconnected: (event) => {
            // ...
        },
    });
    ```

- fc83a44: Enable `onUserConnected` and `onUserDisconnected` event listeners.
- be1488f: Validate webhook signatures via webhook secrets.

    ```ts
    import { createIO } from "@pluv/platform-pluv";

    const io = createIO({
        // ...
        // If you provide a webhookSecret
        webhookSecret: "whsec_...",

        // The following properties will be made available to configure
        getInitialStorage: (event) => {
            /* ... */
        },
        onRoomDeleted: (event) => {
            /* ... */
        },
        onUserConnected: (event) => {
            /* ... */
        },
        onUserDisconnected: (event) => {
            /* ... */
        },
    });
    ```

- Updated dependencies [c0956e7]
    - @pluv/io@0.32.6
    - @pluv/crdt@0.32.6
    - @pluv/types@0.32.6

## 0.32.5

### Patch Changes

- @pluv/crdt@0.32.5
- @pluv/io@0.32.5
- @pluv/types@0.32.5

## 0.32.4

### Patch Changes

- @pluv/crdt@0.32.4
- @pluv/io@0.32.4
- @pluv/types@0.32.4

## 0.32.3

### Patch Changes

- cce989d: Added properties for internal use only.
- 5a3114f: Fixed thrown error when calling `createToken`.
- Updated dependencies [bb21274]
    - @pluv/io@0.32.3
    - @pluv/crdt@0.32.3
    - @pluv/types@0.32.3

## 0.32.2

### Patch Changes

- Updated dependencies [890d45b]
    - @pluv/io@0.32.2
    - @pluv/crdt@0.32.2
    - @pluv/types@0.32.2

## 0.32.1

### Patch Changes

- 7ae3df3: Update endpoint to generate authorization tokens.
    - @pluv/crdt@0.32.1
    - @pluv/io@0.32.1
    - @pluv/types@0.32.1

## 0.32.0

### Patch Changes

- Updated dependencies [cde5305]
    - @pluv/io@0.32.0
    - @pluv/crdt@0.32.0
    - @pluv/types@0.32.0

## 0.31.0

### Minor Changes

- b3c31d7: **BREAKING**

    Fixed platform context types. This will require additional properties when registering a websocket and creating authorization tokens. See example below:

    ```ts
    // @pluv/platform-node example

    import { platformNode } from "@pluv/platform-node";
    import { createIO } from "@pluv/io";
    import type { IncomingMessage } from "node:http";
    import { z } from "zod";

    const io = createIO({
        // If using a function authorize parameter, `req` is now available as a param
        authorize: ({ req }) => ({
            required: true,
            secret: "MY-CUSTOM-SECRET",
            user: z.object({
                id: z.string(),
            }),
        }),
        platformNode(),
    });

    // Before
    io.createToken({
        room: "my-custom-room",
        user: { id: "abc123" },
    });

    // After
    io.createToken({
        room: "my-custom-room",
        user: { id: "abc123" },

        // Previously not required, but now required
        req: req as IncomingMessage,
    });
    ```

    ```ts
    // @pluv/platform-cloudflare example

    import { platformCloudflare } from "@pluv/platform-cloudflare";
    import { createIO } from "@pluv/io";
    import { z } from "zod";

    const io = createIO({
        // If using a function authorize parameter, `env` and `request` are now available as params
        authorize: ({ env, request }) => ({
            required: true,
            secret: "MY-CUSTOM-SECRET",
            user: z.object({
                id: z.string(),
            }),
        }),
        platformCloudflare(),
    });

    // Before
    io.createToken({
        room: "my-custom-room",
        user: { id: "abc123" },
    });

    // After
    io.createToken({
        room: "my-custom-room",
        user: { id: "abc123" },

        // Previously not required, but now required
        env: env as Env,
        request: request as Request,
    });
    ```

### Patch Changes

- Updated dependencies [b3c31d7]
    - @pluv/io@0.31.0
    - @pluv/crdt@0.31.0
    - @pluv/types@0.31.0

## 0.30.2

### Patch Changes

- @pluv/crdt@0.30.2
- @pluv/io@0.30.2
- @pluv/types@0.30.2

## 0.30.1

### Patch Changes

- 47784d5: Add missing `publicKey` param to `createIO`.
- Updated dependencies [b9c3633]
    - @pluv/io@0.30.1
    - @pluv/crdt@0.30.1
    - @pluv/types@0.30.1

## 0.30.0

### Minor Changes

- fa496a2: Add new package `@pluv/platform-pluv`.

### Patch Changes

- Updated dependencies [7246a9e]
    - @pluv/io@0.30.0
    - @pluv/crdt@0.30.0
    - @pluv/types@0.30.0
